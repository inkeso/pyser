#!/usr/bin/env python3
# -*- coding: utf-8 -*-

PAGES = {
    "UTF-8": [ # only escape low bytes, except LF. Remove CR. Default.
        "^@","^A","^B","^C","^D","^E","^F","^G","^H","^I","\n","^K","^L","","^N","^O",
        "^P","^Q","^R","^S","^T","^U","^V","^W","^X","^Y","^Z","^[","^\\","^]","^^","^_"
    ],

    "ASCII": [
        "<NUL>","<SOH>","<STX>","<ETX>","<EOT>","<ENQ>","<ACK>","<BEL>","<BS>","<HT>","\n","<VT>","<FF>","<CR>","<SO>","<SI>",
        "<DLE>","<DC1>","<DC2>","<DC3>","<DC4>","<NAK>","<SYN>","<ETB>","<CAN>","<EM>","<SUB>","<ESC>","<FS>","<GS>","<RS>","<US>"
    ] + [chr(x) for x in range(32,127)] + ["<%02X>" % x for x in range(127,256)],
    
    "ISO 8859-15": [
        "<NUL>","<SOH>","<STX>","<ETX>","<EOT>","<ENQ>","<ACK>","<BEL>","<BS>","<HT>","\n","<VT>","<FF>","<CR>","<SO>","<SI>",
        "<DLE>","<DC1>","<DC2>","<DC3>","<DC4>","<NAK>","<SYN>","<ETB>","<CAN>","<EM>","<SUB>","<ESC>","<FS>","<GS>","<RS>","<US>"
        ] + [chr(x) for x in range(32,127)] + ["<DEL>",
        "<PAD>", "<HOP>", "<BPH>", "<NBH>", "<IND>", "<NEL>", "<SSA>", "<ESA>", "<HTS>", "<HTJ>", "<VTS>", "<PLD>", "<PLU>", "<RI>", "<SS2>", "<SS3>",
        "<DCS>", "<PU1>", "<PU2>", "<STS>", "<CCH>", "<MW>", "<SPA>", "<EPA>", "<SOS>", "<SGCI>", "<SCI>", "<CSI>", "<ST>", "<OSC>", "<PM>", "<APC>",
        " ", "¡", "¢", "£", "€", "¥", "Š", "§", "š", "©", "ª", "«", "¬", "<SHY>", "®", "¯",
        "°", "±", "²", "³", "Ž", "µ", "¶", "·", "ž", "¹", "º", "»", "Œ", "œ", "Ÿ", "¿",
        "À", "Á", "Â", "Ã", "Ä", "Å", "Æ", "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï",
        "Ð", "Ñ", "Ò", "Ó", "Ô", "Õ", "Ö", "×", "Ø", "Ù", "Ú", "Û", "Ü", "Ý", "Þ", "ß",
        "à", "á", "â", "ã", "ä", "å", "æ", "ç", "è", "é", "ê", "ë", "ì", "í", "î", "ï",
        "ð", "ñ", "ò", "ó", "ô", "õ", "ö", "÷", "ø", "ù", "ú", "û", "ü", "ý", "þ", "ÿ"
    ], 

    "CP437": [
        " ","☺", "☻", "♥", "♦", "♣", "♠", "•", "◘", "○", "\n", "♂", "♀", "♪", "♫", "☼",
        "►", "◄", "↕", "‼", "¶", "§", "▬", "↨", "↑", "↓", "→", "←", "∟", "↔", "▲", "▼"
        ] + [chr(x) for x in range(32,127)] + [ "⌂",
        "Ç", "ü", "é", "â", "ä", "à", "å", "ç", "ê", "ë", "è", "ï", "î", "ì", "Ä", "Å",
        "É", "æ", "Æ", "ô", "ö", "ò", "û", "ù", "ÿ", "Ö", "Ü", "¢", "£", "¥", "₧", "ƒ",
        "á", "í", "ó", "ú", "ñ", "Ñ", "ª", "º", "¿", "⌐", "¬", "½", "¼", "¡", "«", "»",
        "░", "▒", "▓", "│", "┤", "╡", "╢", "╖", "╕", "╣", "║", "╗", "╝", "╜", "╛", "┐",
        "└", "┴", "┬", "├", "─", "┼", "╞", "╟", "╚", "╔", "╩", "╦", "╠", "═", "╬", "╧",
        "╨", "╤", "╥", "╙", "╘", "╒", "╓", "╫", "╪", "┘", "┌", "█", "▄", "▌", "▐", "▀",
        "α", "ß", "Γ", "π", "Σ", "σ", "µ", "τ", "Φ", "Θ", "Ω", "δ", "∞", "φ", "ε", "∩",
        "≡", "±", "≥", "≤", "⌠", "⌡", "÷", "≈", "°", "∙", "·", "√", "ⁿ", "²", "■", " " 
    ],
    
    "CP850": [
        " ","☺", "☻", "♥", "♦", "♣", "♠", "•", "◘", "○", "\n", "♂", "♀", "♪", "♫", "☼",
        "►", "◄", "↕", "‼", "¶", "§", "▬", "↨", "↑", "↓", "→", "←", "∟", "↔", "▲", "▼"
        ] + [chr(x) for x in range(32,127)] + [ "⌂",
        "Ç", "ü", "é", "â", "ä", "à", "å", "ç", "ê", "ë", "è", "ï", "î", "ì", "Ä", "Å",  
        "É", "æ", "Æ", "ô", "ö", "ò", "û", "ù", "ÿ", "Ö", "Ü", "ø", "£", "Ø", "×", "ƒ",  
        "á", "í", "ó", "ú", "ñ", "Ñ", "ª", "º", "¿", "®", "¬", "½", "¼", "¡", "«", "»",  
        "░", "▒", "▓", "│", "┤", "Á", "Â", "À", "©", "╣", "║", "╗", "╝", "¢", "¥", "┐",  
        "└", "┴", "┬", "├", "─", "┼", "ã", "Ã", "╚", "╔", "╩", "╦", "╠", "═", "╬", "¤",  
        "ð", "Ð", "Ê", "Ë", "È", "ı", "Í", "Î", "Ï", "┘", "┌", "█", "▄", "¦", "Ì", "▀",  
        "Ó", "ß", "Ô", "Ò", "õ", "Õ", "µ", "þ", "Þ", "Ú", "Û", "Ù", "ý", "Ý", "¯", "´",  
        "–", "±", "‗", "¾", "¶", "§", "÷", "¸", "°", "¨", "·", "¹", "³", "²", "■", " "
    ]
}

def translate(s, page="UTF-8"):
    """translate bytearray to desired codepage visually (returns UTF-8)"""
    if page == "UTF-8":
        s = s.decode("UTF-8", "replace")
        for j in range(len(PAGES["UTF-8"])): s = s.replace(chr(j), PAGES["UTF-8"][j])
        return s
    else:
        return "".join(PAGES[page][x] for x in s)
